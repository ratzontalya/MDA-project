/*VIEW 1*/
CREATE VIEW CALLS 
AS 
SELECT  *
FROM CALLHELP 
NATURAL JOIN DISPATCHER 
NATURAL JOIN SENDTEAM
NATURAL JOIN TEAM
NATURAL JOIN DRIVER
NATURAL JOIN PARTICIPANTPARAMEDIC
NATURAL JOIN PARTICIPANTVOLUNTEER
NATURAL JOIN PARAMEDIC
JOIN ITEM ON AMBULANCEID=ITEMID
ORDER BY CALLID;


/*SELECT*/
SELECT * FROM CALLS;

/*1*/
SELECT CALLID, CALLDATE, COUNT(DISTINCT(DISPATCHERID)) AS DISPATCHERS, 
       COUNT(DISTINCT(DRIVERID)) AS DRIVERS, COUNT(DISTINCT(PARAMEDICID)) AS PARAMEDICS, 
       COUNT(DISTINCT(VOLUNTEERID)) AS VOLUNTEERS
FROM CALLS
WHERE CALLDATE > '01-JAN-2000'
GROUP BY CALLID, CALLDATE;

/*2*/
SELECT DISTINCT(PARAMEDICID) AS HERO
FROM CALLS
WHERE PARAMEDICID IN (SELECT DISPATCHERID
                      FROM CALLS)
UNION
SELECT DISTINCT(DRIVERID) AS HERO
FROM CALLS
WHERE DRIVERID IN (SELECT DISPATCHERID
                      FROM CALLS);     
                      
/*DROP*/
DROP VIEW CALLS;
