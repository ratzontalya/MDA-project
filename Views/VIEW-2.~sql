/*VIEW 1*/
CREATE VIEW ITEMS
AS 
SELECT  ITEMID,ORDERID, 'FALSE' AS DONATED, WAREHOUSEID, STOREKEEPERID AS StorekeeperOrDonor
FROM ITEM
NATURAL JOIN ORDERING
NATURAL JOIN WAREHOUSE
NATURAL JOIN STOREKEEPER
UNION
SELECT ITEMID,DONATIONID, 'TRUE' AS DONATED, NULL, DONORID
FROM ITEM
NATURAL JOIN DONATEITEM
NATURAL JOIN DONATION
UNION
SELECT ITEMID, NULL, 'UNKNOWN', NULL,NULL
FROM ITEM
WHERE ORDERID IS NULL AND ITEMID NOT IN (SELECT ITEMID FROM DONATEITEM);

/*SELECT*/
SELECT * FROM ITEMS;

/*1*/
SELECT DONATED, COUNT(*) AS NUM_ITEMS
FROM ITEMS
GROUP BY DONATED;
/*2*/
SELECT StorekeeperOrDonor
FROM ITEMS
WHERE StorekeeperOrDonor IS NOT NULL
GROUP BY StorekeeperOrDonor
HAVING COUNT(*) > 1;   
                      
/*DROP*/
DROP VIEW ITEMS;












/*SELECT  I.ITEMID,O.ORDERID, 'FALSE' AS DONATED, I.WAREHOUSEID, O.STOREKEEPERID
FROM ITEM I
LEFT JOIN ORDERING O ON O.ORDERID = I.ORDERID
LEFT JOIN WAREHOUSE W ON W.WAREHOUSEID = I.WAREHOUSEID
LEFT JOIN STOREKEEPER S ON S.STOREKEEPERID = O.STOREKEEPERID
WHERE ITEMID NOT IN (SELECT ITEMID FROM DONATEITEM)*/
